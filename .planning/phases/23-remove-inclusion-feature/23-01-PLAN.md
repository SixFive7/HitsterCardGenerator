---
phase: 23-remove-inclusion-feature
plan: 01
type: execute
---

<objective>
Remove the "included/excluded" card curation feature from the UI and all code paths.

Purpose: The inclusion feature was designed for curating cards before export, but it adds unnecessary complexity. All matched cards should be included by default.
Output: Clean codebase with inclusion feature completely removed from store, types, and UI components.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Files to modify:**
@web/src/lib/stores/cardCustomization.svelte.ts
@web/src/lib/types.ts
@web/src/lib/CardPreview/CardControls.svelte
@web/src/App.svelte

**What to remove:**
1. Store (cardCustomization.svelte.ts):
   - `STORAGE_KEY_INCLUDED` constant
   - `loadIncludedCards()` function
   - `saveIncludedCards()` function
   - `includedCards` state variable
   - `toggleCardInclusion()` function
   - `initializeIncludedCards()` function
   - `isCardIncluded()` function
   - `getIncludedCount()` function
   - `includedCards` from `getCardCustomizationState()` return

2. Types (types.ts):
   - `includedCards` from `CardCustomization` interface

3. CardControls (CardControls.svelte):
   - `isIncluded` prop
   - `onToggleInclude` prop
   - Toggle button (Included/Excluded)
   - Associated styles

4. App.svelte:
   - Imports: `initializeIncludedCards`, `toggleCardInclusion`, `isCardIncluded`, `getIncludedCount`
   - `initializeIncludedCards()` calls
   - `localStorage.removeItem('hitster-included-cards')` call
   - `handleToggleInclude()` function
   - `includedCount` derived value
   - Included/Excluded count display in UI
   - `isIncluded` and `onToggleInclude` props passed to CardControls
   - Filter on export: `matchResults.filter((_, index) => isCardIncluded(index))`
   - `includedCount === 0` disabled check on export button
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove inclusion logic from store and types</name>
  <files>web/src/lib/stores/cardCustomization.svelte.ts, web/src/lib/types.ts</files>
  <action>
    In cardCustomization.svelte.ts:
    - Remove `STORAGE_KEY_INCLUDED` constant (line 50)
    - Remove `loadIncludedCards()` function (lines 66-78)
    - Remove `saveIncludedCards()` function (lines 90-97)
    - Remove `includedCards` state variable (line 101)
    - Remove `toggleCardInclusion()` export function (lines 122-131)
    - Remove `initializeIncludedCards()` export function (lines 152-155)
    - Remove `isCardIncluded()` export function (lines 160-162)
    - Remove `getIncludedCount()` export function (lines 167-169)
    - Remove `includedCards` getter from `getCardCustomizationState()` return object (line 175)

    In types.ts:
    - Remove `includedCards: Set<number>` from `CardCustomization` interface (line 67)
  </action>
  <verify>No TypeScript errors in the store file. Types file compiles without errors.</verify>
  <done>Store only contains genre color logic. CardCustomization type only has genreColors and currentCardIndex.</done>
</task>

<task type="auto">
  <name>Task 2: Remove inclusion UI from components</name>
  <files>web/src/lib/CardPreview/CardControls.svelte, web/src/App.svelte</files>
  <action>
    In CardControls.svelte:
    - Remove `isIncluded` from Props interface (line 10)
    - Remove `onToggleInclude` from Props interface (line 13)
    - Remove these from props destructuring (line 17)
    - Remove the entire toggle button (lines 46-65)
    - Remove `.toggle-button` styles (lines 170-206)
    - Update component comment to remove "include/exclude toggle" mention

    In App.svelte:
    - Remove imports: `initializeIncludedCards`, `toggleCardInclusion`, `isCardIncluded`, `getIncludedCount` from cardCustomization store
    - Remove `initializeIncludedCards(matchResults.length)` calls (lines 135 and 148)
    - Remove `localStorage.removeItem('hitster-included-cards')` from handleStartOver (line 179)
    - Remove `handleToggleInclude()` function (lines 198-199)
    - Remove `includedCount` derived value (line 218)
    - Remove Included/Excluded count display (lines 541-548)
    - Remove `isIncluded` prop from CardControls (line 568)
    - Remove `onToggleInclude` prop from CardControls (line 571)
    - Change export filter from `matchResults.filter((_, index) => isCardIncluded(index))` to just `matchResults` (line 606)
    - Change export button disabled check from `includedCount === 0` to `matchResults.length === 0` (line 592)
    - Update export button text from `Continue to Export (${includedCount} cards)` to `Continue to Export (${matchResults.length} cards)` (line 595)
  </action>
  <verify>Run `npm run build` in web directory - no TypeScript or build errors. Run `npm run check` for type checking.</verify>
  <done>No inclusion-related props, functions, or UI elements remain. Export uses all matched results directly.</done>
</task>

<task type="auto">
  <name>Task 3: Visual verification and cleanup</name>
  <files>N/A</files>
  <action>
    1. Start the dev server: `dotnet run` from project root
    2. Use Chrome DevTools MCP to navigate to http://localhost:5000
    3. Upload a test CSV or use playlist builder to get to card preview
    4. Take screenshot of CardControls area to verify toggle button is gone
    5. Verify only Previous, card counter, Flip, and Next buttons remain
    6. Verify export button shows correct card count
  </action>
  <verify>Screenshot shows clean CardControls without inclusion toggle. Export works with all cards.</verify>
  <done>UI visually verified clean. No inclusion feature visible anywhere.</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `cd web && npm run build` succeeds without errors
- [ ] `cd web && npm run check` passes type checking
- [ ] No references to "included" or "inclusion" remain in modified files (except comments if any)
- [ ] CardControls only shows: Previous, Counter, Flip, Next
- [ ] Export uses all matched results without filtering
</verification>

<success_criteria>
- All inclusion-related code removed from store, types, and components
- No TypeScript or build errors
- UI clean without toggle button
- Export functionality works with all cards
</success_criteria>

<output>
After completion, create `.planning/phases/23-remove-inclusion-feature/23-01-SUMMARY.md`
</output>
